[gd_scene load_steps=29 format=3 uid="uid://do1xjjm1ptao"]

[ext_resource type="Script" path="res://brain/Camera.cs" id="1_f6jas"]
[ext_resource type="Script" path="res://levels/Level.cs" id="1_ypbtj"]
[ext_resource type="PackedScene" uid="uid://bantfsh2sxy0v" path="res://ui/hud.tscn" id="2_wxw3l"]
[ext_resource type="Shape3D" uid="uid://fq5v2apmp1qq" path="res://assets/shape_floor.tres" id="4_5qor6"]
[ext_resource type="PackedScene" uid="uid://cirg5lcesnafx" path="res://player/player.tscn" id="5_vkgtl"]
[ext_resource type="Script" path="res://characters/Bird.cs" id="6_m0or4"]
[ext_resource type="Script" path="res://components/StateManager.cs" id="7_ntb0s"]
[ext_resource type="Texture2D" uid="uid://uhj6s1h4i0fn" path="res://assets/texture/face5.png" id="8_fcj1v"]
[ext_resource type="Script" path="res://util/TimerRandomInterval.cs" id="8_k53kt"]
[ext_resource type="Texture2D" uid="uid://bdvs7gnwd2yjr" path="res://assets/texture/Environment/Grass/slot0_albedo_bump.png" id="9_asfog"]
[ext_resource type="Texture2D" uid="uid://kcuf6ymo1uav" path="res://assets/texture/Environment/Grass/Grass.png" id="10_yro5q"]
[ext_resource type="Script" path="res://characters/Enemy.cs" id="12_6700b"]
[ext_resource type="Texture2D" uid="uid://cx2e16kdao4as" path="res://assets/texture/face2.png" id="13_tqtjf"]
[ext_resource type="Script" path="res://brain/CollisionZone.cs" id="14_euwly"]
[ext_resource type="Texture2D" uid="uid://cfqej0rp1hi0y" path="res://assets/texture/face0.png" id="15_kg7hs"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_mu5b3"]
sky_top_color = Color(0.541176, 0.423529, 0.290196, 1)
sky_horizon_color = Color(0.676471, 0.65, 0.614706, 1)
sky_energy_multiplier = 1.5
ground_bottom_color = Color(0.164706, 0.176471, 0.168627, 1)
ground_horizon_color = Color(0.676471, 0.65, 0.614706, 1)

[sub_resource type="Sky" id="Sky_esjiq"]
sky_material = SubResource("ProceduralSkyMaterial_mu5b3")

[sub_resource type="Environment" id="Environment_jq7mq"]
background_mode = 2
sky = SubResource("Sky_esjiq")
ambient_light_source = 1
tonemap_mode = 2

[sub_resource type="NavigationMesh" id="NavigationMesh_ckcui"]
vertices = PackedVector3Array(-24.5, 0.5, -24.5, -24.5, 0.5, 24.5, 24.5, 0.5, 24.5, 24.5, 0.5, -24.5)
polygons = [PackedInt32Array(3, 2, 0), PackedInt32Array(0, 2, 1)]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_e7sen"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_p5l8s"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_mcwpa"]
specular_mode = 1
metallic_specular = 0.34
roughness_texture_channel = 1
refraction_texture_channel = 4

[sub_resource type="PlaneMesh" id="PlaneMesh_my3tk"]
material = SubResource("StandardMaterial3D_mcwpa")
size = Vector2(50, 50)

[sub_resource type="SphereShape3D" id="SphereShape3D_sddu7"]

[sub_resource type="BoxShape3D" id="BoxShape3D_w2bov"]

[sub_resource type="SphereShape3D" id="SphereShape3D_f25d6"]
radius = 2.1

[sub_resource type="SphereShape3D" id="SphereShape3D_05en4"]
radius = 18.236

[sub_resource type="SphereShape3D" id="SphereShape3D_mew7e"]
radius = 7.381

[node name="Wod" type="Node3D" node_paths=PackedStringArray("sunlight", "navRegion")]
script = ExtResource("1_ypbtj")
sunlight = NodePath("DirectionalLight3D")
navRegion = NodePath("NavigationRegion3D")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_jq7mq")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.707602, 0.287481, -0.645488, 0.244313, 0.757621, 0.605245, 0.663032, -0.585974, 0.465858, -3.27003, 36.1152, 10.5027)
light_color = Color(0.796172, 0.801828, 0.649819, 1)
light_energy = 0.92
light_indirect_energy = 0.16
light_angular_distance = 4.05
shadow_enabled = true
shadow_bias = 0.0
shadow_normal_bias = 1.0
shadow_opacity = 0.85
shadow_blur = 0.5
directional_shadow_fade_start = 0.74
directional_shadow_pancake_size = 17.4
sky_mode = 1

[node name="HUD" parent="." instance=ExtResource("2_wxw3l")]

[node name="Camera3D" type="Camera3D" parent="." node_paths=PackedStringArray("target", "HUD")]
script = ExtResource("1_f6jas")
target = NodePath("../Player")
HUD = NodePath("../HUD")

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
navigation_mesh = SubResource("NavigationMesh_ckcui")

[node name="Floor" type="StaticBody3D" parent="NavigationRegion3D"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="NavigationRegion3D/Floor"]
shape = ExtResource("4_5qor6")

[node name="MeshInstance3D" type="MeshInstance3D" parent="NavigationRegion3D/Floor/CollisionShape3D"]
material_override = SubResource("StandardMaterial3D_e7sen")
material_overlay = SubResource("StandardMaterial3D_p5l8s")
cast_shadow = 0
gi_mode = 2
mesh = SubResource("PlaneMesh_my3tk")
skeleton = NodePath("../..")

[node name="Player" parent="." instance=ExtResource("5_vkgtl")]
transform = Transform3D(1, 0.000750492, 0, -0.000750492, 1, 0, 0, 0, 1, 17.1354, 0, -13.2163)

[node name="Bird" type="Node3D" parent="." node_paths=PackedStringArray("stations", "nav", "physBody", "stateManager")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 4.69976, 0)
script = ExtResource("6_m0or4")
stations = [NodePath("../Tree"), NodePath("../Tree2")]
nav = NodePath("NavigationAgent3D")
physBody = NodePath("CharacterBody3D")
stateManager = NodePath("StateManager")

[node name="StateManager" type="Node3D" parent="Bird" node_paths=PackedStringArray("subject")]
script = ExtResource("7_ntb0s")
states = ["Idle", 1]
subject = NodePath("..")

[node name="Timer" type="Timer" parent="Bird"]
wait_time = 5.356
autostart = true
script = ExtResource("8_k53kt")
baseWaitTime = 4

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="Bird"]

[node name="CharacterBody3D" type="CharacterBody3D" parent="Bird"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Bird/CharacterBody3D"]
shape = SubResource("SphereShape3D_sddu7")

[node name="Sprite3D" type="Sprite3D" parent="Bird/CharacterBody3D"]
texture = ExtResource("8_fcj1v")

[node name="Tree" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -7.04748, 6.1454, 11.7115)

[node name="Sprite3D" type="Sprite3D" parent="Tree"]
texture = ExtResource("9_asfog")

[node name="Tree2" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.31682, 7.81176, -9.13488)

[node name="Sprite3D" type="Sprite3D" parent="Tree2"]
texture = ExtResource("10_yro5q")

[node name="Enemy1" type="Node3D" parent="." node_paths=PackedStringArray("nav", "physBody", "stateManager")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 20.2543, 2.83912, 19.2371)
script = ExtResource("12_6700b")
nav = NodePath("NavigationAgent3D")
physBody = NodePath("CharacterMotionModule")
stateManager = NodePath("StateManager")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="Enemy1"]

[node name="StateManager" type="Node3D" parent="Enemy1" node_paths=PackedStringArray("subject")]
script = ExtResource("7_ntb0s")
states = Array[int]([0, 1, 4])
subject = NodePath("..")

[node name="CharacterMotionModule" type="CharacterBody3D" parent="Enemy1"]

[node name="Sprite3D" type="Sprite3D" parent="Enemy1/CharacterMotionModule"]
texture = ExtResource("13_tqtjf")

[node name="Body" type="CollisionShape3D" parent="Enemy1/CharacterMotionModule"]
shape = SubResource("BoxShape3D_w2bov")

[node name="Area3D2" type="Area3D" parent="Enemy1/CharacterMotionModule"]
script = ExtResource("14_euwly")
zone = 1

[node name="AttackZone" type="CollisionShape3D" parent="Enemy1/CharacterMotionModule/Area3D2"]
shape = SubResource("SphereShape3D_f25d6")

[node name="Area3D3" type="Area3D" parent="Enemy1/CharacterMotionModule"]
script = ExtResource("14_euwly")

[node name="ChaseZone" type="CollisionShape3D" parent="Enemy1/CharacterMotionModule/Area3D3"]
shape = SubResource("SphereShape3D_05en4")

[node name="Enemy2" type="Node3D" parent="." node_paths=PackedStringArray("nav", "physBody", "stateManager")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.63792, 2.83912, 19.2371)
script = ExtResource("12_6700b")
nav = NodePath("NavigationAgent3D")
physBody = NodePath("CharacterMotionModule")
stateManager = NodePath("StateManager")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="Enemy2"]

[node name="StateManager" type="Node3D" parent="Enemy2" node_paths=PackedStringArray("subject")]
script = ExtResource("7_ntb0s")
states = Array[int]([3, 1])
defaultState = 3
subject = NodePath("..")

[node name="CharacterMotionModule" type="CharacterBody3D" parent="Enemy2"]

[node name="Sprite3D" type="Sprite3D" parent="Enemy2/CharacterMotionModule"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.35085, 0, 0)
texture = ExtResource("15_kg7hs")

[node name="Body" type="CollisionShape3D" parent="Enemy2/CharacterMotionModule"]
shape = SubResource("BoxShape3D_w2bov")

[node name="Area3D2" type="Area3D" parent="Enemy2/CharacterMotionModule"]
script = ExtResource("14_euwly")
zone = 1

[node name="AttackZone" type="CollisionShape3D" parent="Enemy2/CharacterMotionModule/Area3D2"]
shape = SubResource("SphereShape3D_f25d6")

[node name="Area3D3" type="Area3D" parent="Enemy2/CharacterMotionModule"]
script = ExtResource("14_euwly")

[node name="ChaseZone" type="CollisionShape3D" parent="Enemy2/CharacterMotionModule/Area3D3"]
shape = SubResource("SphereShape3D_mew7e")

[connection signal="StateChange" from="Bird/StateManager" to="Bird" method="OnStateChange"]
[connection signal="timeout" from="Bird/Timer" to="Bird" method="SwitchActivity"]
